---
title: "Micro, pequeñas y medianas empresas en el Uruguay."
title-block-banner: true
author: "Gonzalo Ruiz <gonzaaruizz22@gmail.com>"
format:
  revealjs:
    theme: night
    footer: Facultad de Ciencias Económicas y de Administración, UdelaR.
---

```{r}
# echo: false
library(tidyverse)
```


## Introducción

Actualmente me encuentro cursando un Proyecto de Investigación Estudiantil, y es dentro de éste contexto que es del interés del equipo ir conociendo los aportes al desarrollo territorial de las empresas PYMES del Uruguay.
¿Cómo se constituyen? ¿Cómo y cuánto participan de la actividad económica? ¿Está sujeta a la situación socio-educativa del país?

## Descripción

::: {.incremental}

-   Datos extraídos de múltiples fuentes
  -   ANDE, IDERE, OPP
-   La serie comprende desde el año 2008 hasta el 2022(*)
-   Está desagregada a nivel anual, departamental, por tamaño de empresa y sector(*) en la actividad económica
-   Consta de 17775 y 20 variables

:::

## Variables

**PYMES**:

-   Numero de empresas, numero de nacimientos y numero de muertes

**Socio-educativas**:

-   alfabetismo, acceso a estudios terciarios, años de educación en promedio, ...

**Económicas**:

-   pobreza, informalidad, ingreso de los hogares, ...

---

::: {.panel-tabset}

### OPP

```{r}
read_delim(
  here::here("data/proyecto/indicadores/participacion-departamental-actividad-economica.csv"),
  show_col_types = FALSE
) |>
  pivot_longer(cols = where(is.numeric), names_to="anio", values_to="part_act_econ") |>
  mutate(anio = as.character(anio), departamento = tolower(trimws(chartr("áéíóú", "aeiou", departamento)))) |>
  head()
```

### IDERE

```{r}
readxl::read_xlsx(
  here::here("data/proyecto/indicadores/idere.xlsx"),
  sheet = 1,
) |>
  rename_with(~ tolower(gsub(" ", "_", .x, fixed=T))) |>
  rename(
    gini="gini_(distribución_del_ingreso)",
    ingresos_de_los_hogares="ingresos_de_los_hogares_(en_proporción_del_promedio_país)"
  ) |>
  rename_with(~ chartr("áéíóú", "aeiou", .x)) |>
  rename_with(~ gsub("ñ", "ni", .x, fixed=T)) |>
  filter(!departamento %in% c("Promedio", "Máximo", "Mínimo")) |>
  select(
    departamento,
    anio,
    alfabetismo,
    accesos_a_estudios_terciarios,
    anios_de_educacion_promedio,
    promocion_educacion_media_cb,
    pobreza,
    informalidad,
    desempleo_en_jovenes,
    gini,
    acceso_a_internet,
    ingresos_de_los_hogares,
    tasa_de_desempleo,
    porcentaje_de_personal_presupuestado_en_la_intendencia
  ) |>
  mutate(anio = as.character(anio), departamento = tolower(trimws(chartr("áéíóú", "aeiou", departamento)))) |>
  head()
```

### PYMES

```{r}
list.files("data/proyecto/pymes/n-empresas", full.names = T) |>
  lapply(readxl::read_xlsx) |>
  bind_rows() |>
  rename_with(~ tolower(gsub("ñ", "ni", .x, fixed=T))) %>%
  rename(n_empresas="valor") |>
  select(-indicador) |>
  head()
```
:::

## Problematicas

-   Unir datos de diversas fuentes (transformarlos, estandarizarlos, etc)

-   Datos faltantes

-   Temporalidad

![](pymes_files/figure-html/pct-faltantes-1.png){.absolute top=340 left=0 width="450" height="350"}
![](pymes_files/figure-html/pct-faltantes-sin-sector-1.png){.absolute top=340 right=50 width="450" height="350"}
---

## PYMES

![](pymes_files/figure-html/dist-num-vars-pymes-plots-1){.absolute top=100 left=0 width="450" height="250"}

![](pymes_files/figure-html/dist-num-vars-pymes-plots-2){.absolute top=100 right=0 width="450" height="250"}

![](pymes_files/figure-html/dist-num-vars-pymes-plots-3){.absolute top=375 left=0 width="450" height="250"}

![](pymes_files/figure-html/dist-num-vars-pymes-plots-3){.absolute top=375 right=0 width="450" height="250"}

## Y con las otras variables?

::: {.incremental}

![](pymes_files/figure-html/interaccion-n-empresas-vars-educ-1){.absolute top=100 left=100 width="640" height="480"}

---

![](pymes_files/figure-html/interaccion-n-empresas-econ-vars-1){.absolute top=100 left=100 width="640" height="480"}

:::


## Cómo evolucionó la variable a lo largo del tiempo?

![](pymes_files/figure-html/unnamed-chunk-3-1){.absolute top=200 left=0 width="550" height="350"}

![](pymes_files/figure-html/unnamed-chunk-4-1){.absolute top=300 right=0 width="550" height="350"}


## Modelado

-   Se experimentó con 3 modelos distintos
  -   lm, random forest, xgboost
-   Se intentó contemplar no linealidad y robustez ante las categorias

```{r}
read_csv(here::here("data/proyecto/metricas.csv"))
```


---

```{r}
read_csv(here::here("data/proyecto/estimacion.csv")) |>
  head(15)
```


## Importancia de las variables independientes

- *Random Forest*

![](pymes_files/figure-html/unnamed-chunk-15-1){.absolute top=215 left=330 width="640" height="480"}

---

- *XGBoost*

![](pymes_files/figure-html/unnamed-chunk-16-1){.absolute top=150 left=200 width="640" height="480"}

# Dudas? Consultas? Sugerencias?

# FIN?